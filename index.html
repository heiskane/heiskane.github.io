<!DOCTYPE html>
<html lang="fi">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
	<script src="https://kit.fontawesome.com/c041fe29b5.js" crossorigin="anonymous"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<title>Niko Heiskanen</title>
</head>
<body>
	<div class="nav">	
		<header>
			<div class="top">
				<ul>
					<li><a href="#">Lorem</a></li>
					<li><a href="#">Pentest</a>
						<ul>
							<li><a href="#">Lorem</a></li>
							<li><a href="#">Ipsum</a></li>
						</ul>
					</li>
				</ul>
			</div>
			<div class="background-image"></div>
			<p class="bg-image-text">Niko Heiskanen<br><br><i class="fas fa-chevron-down"></i></p>
			<div class="main"></div>
		</header>
	</div>
	<div class="main">
		<div class="wrapper">
			<div class="text">
				<h3>Webgoat</h3><br><br><br>
				<h2>Access Control Flaws:</h2><br>
				<h1>Using an Access Control Matrix</h1><br>
				
				<img src="img/1.png">
				<p>After trying what users are able to access account manager resource i found that the user Larry is able to do so.</p><br><br>

				<h1>Bypass a Path Based Access Control Scheme</h1><br>
				<img src="img/2.png">
				<p>For this one i decided to turn on burpsuite to easily change the file the webapp was trying to access. With some trial and error i found that the following request got me access to the required file by going back a few directories, going in WEB-INF and and getting me the spring-security.xml.</p><br><br>

				<h1>LAB: Role Based Access Control</h1><br>
				<p>Stage 1:</p>
				<img src="img/3a.png"><img src="img/3b.png">
				<p>For this one the goal is to delete Toms profile as a regular employee. First i logged in as an admin to see the value for the "delete profile" button. Seeing it is “DeleteProfile” i logged in as normal employee and used burp to intercept the request to view toms profile and changed the action in the request from “ViewProfile” to “DeleteProfile”.</p><br><br>

				<p>Stage 2: Dev Only</p><br><br>

				<p>Stage 3:</p>
				<img src="img/4a.png"><p></p><img src="img/4b.png">
				<p>Now the goal is to view another employees profile as a regular user. Using inspect element in the browser and looking closer at the form i can see a list of emplyees and IDs. As before i logged in as good old tom and intercepted the request to view profile using burp. From there i just changed the value of "employee_id" to Nevilles id (112).</p><br><br>

				<p>Stage 4: Dev Only</p><br><br><br><br>

				<h2>AJAX Security</h2><br>
				<h1>DOM Injection</h1><br>
				<img src="img/5.png">
				<p>As the goal for this was to enable the “Activate” button so i looked at the page source with the inspector again. Looking at it i saw the “disabled” attribute for the button so removing that allowed me to click the button and pass the lesson.</p><br><br>

				<h1>LAB: DOM-Based Cross-Site Scripting</h1><br>
				<p>Stage 1:</p>
				<img src="img/6a.png"><img src="img/6b.png">
				<p>Goal being to deface this website with the provided image i took a look at the image source and simply put that in an image tag as follows:<br>
				&lt;img src="http://localhost:8080/WebGoat/images/logos/owasp.jpg"&gt;</p><br><br>

				<p>Stage 2:</p><br>
				<img src="img/7.png">
				<p>To create a JavaScript alert using the image tag i simply used the “onerror” attribute like this:<br>
				&lt;img onerror='alert("Hello World")'&gt;</p><br><br>

				<p>Stage 3:</p><br>
				<img src="img/8.png">
				<p>This time having to use the iframe tag to create the JavaScript alert i created the tag and used the “onload” attribute to run JavaScript when the object is loaded as the name suggests:<br>
				&lt;iframe onload="alert('Hello World')"&gt;</p><br><br>

				<p>Stage 4:</p>





				<br><br><br><br><br><br><br>
				<h1>Weaponization</h1></br>

				WannaCry is installed by a malicious DLL dropper that attempts to connect to a hardcoded URI upon execution. If the connection is successful, the worm stops running and exits. If the connection fails, dropper attempts to create a service named “mssecsvc2.0”. After that dropper extracts the encrypter binary, writes it and then executes it.
				</br></br></br></br>

				<h1>Delivery</h1></br>

				WannaCry was most likely delivered to victims as a malicious email attachment and spread to anyone on the network using a vulnerability in SMB protocol.</br></br></br></br>

				<h1>Exploit</h1></br>

				WannaCry utilizes the Eternal Blue exploit that allows attackers to remotely execute code and gain access to a network by sending specially crafted packets. It exploits a software vulnerability in Server Message Block (SMB) version 1 protocol, a network file sharing protocol that allows access to files on a remote server. This allowed WannaCry to replicate itself to anyone in the same network. Exploit was found by the NSA then stolen from them and later sold by a group called Shadow Brokers.</br></br></br></br>

				<h1>Installation</h1></br>

				WannaCry encrypts all files with the specified extensions using Microsoft Enhanced RSA and AES Cryptographic Provider libraries and holds these files hostage until pays ransom in exchange for the decryptions key.</br></br></br></br>

				<h1>Command and Control</h1></br>

				WannaCry installs the Tor network anonymity software on the infected system. Tor establishes a SOCKS5 proxy server on the loopback interface (127.0.0.1) that listens on TCP port 9050. WannaCry then connects to this proxy and attempts to contact one of the command and control servers. After connecting to one of the servers, the malware uses a custom encrypted protocol over TCP port 80 through the Tor circuit to transmit encryption keys, to allow victims to communicate with the operators, and to check payment status.</br></br></br></br>

				<h1>Actions</h1></br>

				After infecting a system WannaCry demands a ransom to be paid in bitcoin and displays a timer that counts down to the date when the ransom is doubled and when files will be irrecoverable. WannaCry had spread around the world, infecting more than 230,000 computers in 150 countries and costing approximately $4 billion in financial losses.</br></br></br></br>

				<h1>Sources</h1></br>
				<div class="links">
					<a href="https://attack.mitre.org/software/S0366/" target="_blank">attack.mitre.org/software/S0366</a></br>
					<a href="https://logrhythm.com/blog/a-technical-analysis-of-wannacry-ransomware/" target="_blank">logrhythm.com/blog/a-technical-analysis-of-wannacry-ransomware</a></br>
					<a href="https://www.us-cert.gov/ncas/alerts/TA17-132A" target="_blank">us-cert.gov/ncas/alerts/TA17-132A</a></br>
					<a href="https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html" target="_blank">fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html</a></br>
					<a href="https://www.secureworks.com/research/wcry-ransomware-analysis" target="_blank">secureworks.com/research/wcry-ransomware-analysis</a></br>
					<a href="https://www.cisecurity.org/wp-content/uploads/2019/01/Security-Primer-EternalBlue.pdf" target="_blank">cisecurity.org/wp-content/uploads/2019/01/Security-Primer-EternalBlue.pdf</a></br>
					<a href="https://en.wikipedia.org/wiki/EternalBlue" target="_blank">wikipedia.org/wiki/EternalBlue</a>
				</div>
			</div>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
			</br>
		</div>
	</div>
</body>
</html>